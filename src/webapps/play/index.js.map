{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/api.service.js","webpack:///./src/auth.service.js","webpack:///./src/config.js","webpack:///./src/index.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;ACnEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,oBAAoB,oDAAW,GAAG,MAAM;AACxC;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA,oBAAoB,oDAAW,GAAG,MAAM;AACxC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,0CAA0C,eAAe;AACzD;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA,oBAAoB,oDAAW,GAAG,MAAM;AACxC;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA,C;;;;;;;;;;;;;;;AChEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,C;;;;;;;;;;;;AC1BA;AAAA;AACA;AACA;AACA;;AAEA,qE;;;;;;;;;;;;;;;;ACLA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,oDAAW,UAAU,GAAG;AAC1C;AACA;;AAEA;;AAEA,mEAAyB,QAAQ;AACjC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import Config from './config'\r\nimport AuthService from './auth.service'\r\n\r\nexport default class ApiService {\r\n\r\n  static get(route) {\r\n    const auth = AuthService.getCredentials();\r\n    const token = auth.token;\r\n    \r\n    return fetch(`${Config.api}/${route}`, {\r\n      headers: {\r\n        'x-access-token': token, \r\n      },\r\n      method: 'GET'\r\n    })\r\n    .then(response => {\r\n      if (response.status === 403) {\r\n        AuthService.doLogin();\r\n      }\r\n      else if (response.status === 404) {\r\n        throw 'Not Found';\r\n      } else {\r\n        return response.json();\r\n      }\r\n    });\r\n  }\r\n\r\n  static post(route, params) {\r\n    const auth = AuthService.getCredentials();\r\n    const token = auth.token;\r\n\r\n    return fetch(`${Config.api}/${route}`, {\r\n      method: 'post',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        'x-access-token': token,\r\n      },\r\n      body: params\r\n    })\r\n    .then(res => {\r\n      if (res.status === 400) {\r\n        return res.json().then(error => ({ error: error }));\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n\r\n  static delete(route) {\r\n    const auth = AuthService.getCredentials();\r\n    const token = auth.token;\r\n    \r\n    return fetch(`${Config.api}/${route}`, {\r\n      headers: {\r\n        'x-access-token': token, \r\n      },\r\n      method: 'DELETE'\r\n    })\r\n    .then(response => {\r\n      if (response.status === 403) {\r\n        AuthService.doLogin();\r\n      } else {\r\n        return response.json();\r\n      }\r\n    });\r\n  }\r\n}","\r\nexport default class AuthService {\r\n\r\n\tstatic getCredentials() {\r\n\t\treturn JSON.parse(window.localStorage.getItem('auth'));\r\n\t}\r\n\r\n\tstatic hasCredentials() {\r\n\t\treturn window.localStorage.getItem('auth') !== null;\r\n\t}\r\n\r\n\tstatic getUsername() {\r\n\t\treturn this.hasCredentials()\r\n\t\t\t? this.getCredentials().username\r\n\t\t\t: 'Stranger';\r\n\t}\r\n\r\n\tstatic getUserId() {\r\n    return this.hasCredentials()\r\n      ? this.getCredentials()._id\r\n      : 0;\r\n  }\r\n\r\n\tstatic doLogin() {\r\n\t\twindow.location.href = \"/auth\";\r\n\t}\r\n}","const Config = {\r\n  api: 'http://localhost:8080/api',\r\n  cdn: 'http://localhost:8080/cdn'\r\n};\r\n\r\nexport default Config","import AuthService from './auth.service'\r\nimport ApiService from './api.service'\r\nimport Config from './config';\r\n\r\nif (!AuthService.hasCredentials()) {\r\n  AuthService.doLogin();\r\n}\r\n\r\nconsole.log(AuthService.getUsername());\r\n\r\ndocument.getElementById('user').innerText = AuthService.getUsername();\r\n\r\nconst params = location.search.replace('?', '').split('&');\r\n\r\nlet levelId = 0; // '5aa27062a8669d1a785f511b';\r\nlet redirect = '';\r\n\r\nfor (const param of params) {\r\n  if (param.includes('level=')) {\r\n    levelId = param.replace('level=', '');\r\n  }\r\n  if (param.includes('redirect=')) {\r\n    redirect = param.replace('redirect=', '');\r\n  }\r\n}\r\n\r\nconsole.log(levelId);\r\nconsole.log(redirect);\r\n\r\nif (redirect !== '') {\r\n  const links = document.getElementsByClassName('back');\r\n  for (const link of links) {\r\n    link.innerText = 'Return';\r\n    link.href = redirect;\r\n  };\r\n}\r\n\r\nconst addScript = (id) => {\r\n  const script = document.createElement('script');\r\n  script.src = `${Config.cdn}/levels/${id}`;\r\n  document.body.appendChild(script);\r\n};\r\n\r\nlet hasScores = false;\r\n\r\nApiService.get(`levels/${levelId}`).then(level => {\r\n  console.log(level);\r\n  hasScores = level.hasScores;\r\n  document.getElementById('name').innerText = level.name;\r\n  addScript(levelId);\r\n})\r\n.catch(() => {\r\n  console.log('Not Found');\r\n  document.getElementById('e404').className = 'show';\r\n});\r\n\r\nplayground.events.onLevelFinished = () => {\r\n  console.log('Finished');\r\n  const auth = AuthService.getCredentials();\r\n  const userId = auth._id;\r\n\r\n  var params = new URLSearchParams();\r\n  params.set('levelId', levelId);\r\n  params.set('userId', userId);\r\n  params.set('seconds', 0);\r\n\r\n  console.log(userId);\r\n  document.getElementById('finished').className = 'show';\r\n  document.getElementById('time').innerText = hasScores ? '00:00:00' : '';\r\n  return ApiService.post(`levelsResults`, params);\r\n};\r\n\r\n\r\n"],"sourceRoot":""}